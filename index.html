<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#1E293B">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="DropLit">
  <meta name="application-name" content="DropLit">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
  <meta name="description" content="DropLit - Voice-first idea capture app. Never lose your ideas again.">
  <title>DropLit</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
  <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- App CSS -->
  <link rel="stylesheet" href="css/app.css">
</head>
<body>
  <!-- Insights Banner -->
  <div class="insights-banner" id="insightsBanner">
    <div class="insights-banner-icon">!</div>
    <div class="insights-banner-content">
      <div class="insights-banner-title" id="insightTitle">Reminder</div>
      <div class="insights-banner-text" id="insightText">...</div>
    </div>
    <button class="insights-banner-close" onclick="dismissInsight()">×</button>
  </div>

  <!-- Notification Permission Banner -->
  <div class="notif-banner" id="notifBanner">
    <div class="notif-banner-title">Enable notifications?</div>
    <div class="notif-banner-text">ASKI can remind you about birthdays and important events</div>
    <div class="notif-banner-actions">
      <button class="notif-banner-btn secondary" onclick="dismissNotifBanner()">Later</button>
      <button class="notif-banner-btn primary" onclick="requestNotifPermission()">Enable</button>
    </div>
  </div>

  <div class="app" id="app">
    <header class="header">
      <button class="logo-btn" id="logoBtn" onclick="toggleFilters()" title="Toggle filters">
        <svg viewBox="0 0 24 24" fill="white"><path d="M12 2C12 2 5 10.5 5 15C5 18.866 8.134 22 12 22C15.866 22 19 18.866 19 15C19 10.5 12 2 12 2Z"/></svg>
      </button>
      <div class="header-title"><span>Drop</span>Lit</div>
      <button class="header-add-btn" onclick="togglePlusMenu()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M12 5v14M5 12h14"/></svg>
        Create Drop
      </button>
      <button class="btn-icon" id="menuToggleBtn" onclick="toggleMainMenu()">
        <svg class="menu-icon-open" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
        <svg class="menu-icon-close" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" style="display:none;"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </header>
    <div class="network-banner" id="netBanner">No internet</div>
    <div class="warning" id="warning">Speech recognition not supported. Use Chrome.</div>
    <div class="search-indicator" id="searchIndicator" style="display:none">
      <span class="search-indicator-text">Searching: <span id="searchQueryDisplay"></span></span>
      <button class="search-indicator-clear" onclick="clearSearch()">× Clear</button>
    </div>
    <div class="filters-wrap">
    <div class="filters">
      <div class="time-row" id="timeRow">
        <button class="time-btn" data-time="all">All <span class="cnt" id="cntAll">0</span></button>
        <button class="time-btn" data-time="today">Today <span class="cnt" id="cntToday">0</span></button>
        <button class="time-btn" data-time="7days">7d <span class="cnt" id="cnt7d">0</span></button>
        <button class="sort-btn" id="sortBtn" onclick="toggleSort()" title="Sort order"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg></button>
        <button class="archive-toggle" id="archiveToggle" onclick="toggleArchiveView()" title="Show archive">A</button>
      </div>
      <div class="cat-row" id="cats">
        <button class="cat" data-category="tasks">Tasks <span class="cnt" id="cntTasks">0</span></button>
        <button class="cat" data-category="ideas">Ideas <span class="cnt" id="cntIdeas">0</span></button>
        <button class="cat" data-category="handmagic">Handmagic <span class="cnt" id="cntHandmagic">0</span></button>
        <button class="cat" data-category="design">Design <span class="cnt" id="cntDesign">0</span></button>
        <button class="cat" data-category="bugs">Bugs <span class="cnt" id="cntBugs">0</span></button>
        <button class="cat" data-category="questions">Questions <span class="cnt" id="cntQuestions">0</span></button>
        <button class="cat" data-category="inbox">Inbox <span class="cnt" id="cntInbox">0</span></button>
        <button class="cat" data-category="audio">Audio <span class="cnt" id="cntAudio">0</span></button>
        <button class="cat" data-category="photo">Photo <span class="cnt" id="cntPhoto">0</span></button>
        <button class="cat" data-category="sketch">Sketch <span class="cnt" id="cntSketch">0</span></button>
        <button class="cat" data-category="scan">Scan <span class="cnt" id="cntScan">0</span></button>
        <button class="cat-add" onclick="addCatPrompt()">+</button>
      </div>
    </div>
    </div>
    <div class="ideas-wrap" id="ideasWrap">
      <div class="ideas" id="ideasList"></div>
      <div class="empty" id="emptyState">
        <div class="empty-icon"><svg viewBox="0 0 24 24"><path d="M12 2C12 2 5 10.5 5 15C5 18.866 8.134 22 12 22C15.866 22 19 18.866 19 15C19 10.5 12 2 12 2Z"/></svg></div>
        <div class="empty-title">Your ideas start here</div>
        <div class="empty-text">SHOOT · PRESS · SPEAK</div>
      </div>
    </div>
  </div>

  <button class="fab-camera" id="fabCamera" onclick="document.getElementById('cameraInput').click()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
  </button>
  <input type="file" id="cameraInput" accept="image/*" capture="environment" style="display:none">
  
  <button class="fab" id="fab" onpointerdown="fabDown(event)" onpointerup="fabUp(event)" onpointercancel="fabUp(event)" oncontextmenu="return false;">
    <svg class="mic-icon" viewBox="0 0 24 24" fill="white"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/><path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>
    <div class="rec-ring"></div>
  </button>
  
  <button class="fab-chat" id="fabChat" onclick="toggleChat()">
    <svg viewBox="0 0 24 24" fill="white"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>
  </button>

  <!-- Scroll Buttons -->
  <button class="scroll-btn scroll-top" id="scrollTopBtn" onclick="scrollToTop()">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M18 15l-6-6-6 6"/></svg>
  </button>
  <button class="scroll-btn scroll-bottom" id="scrollBottomBtn" onclick="scrollToBottom()">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M6 9l6 6 6-6"/></svg>
  </button>

  <!-- All modals will be included via JS or kept in separate files -->
  <div id="modalsContainer"></div>

  <!-- JavaScript Modules -->
  <script src="js/config.js"></script>
  <script src="js/state.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/sync.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/drops.js"></script>
  <script src="js/chat.js"></script>
  <script src="js/voice.js"></script>
  <script src="js/modals.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
